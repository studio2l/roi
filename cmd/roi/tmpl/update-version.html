{{template "head.html"}}
{{template "nav.html" $}}
<!--상단 고정 메뉴로 인해 위치 조정-->
<div style="padding-top: 2rem;"></div>
<div class="ui raised very padded text container grey inverted segment">
	<h2 class="ui dividing header">
		버전 수정
	</h2>
	{{with $v := $.Version}}
	<form method="post" class="ui form" enctype="multipart/form-data">
		<div class="field"><label>프로젝트</label>
			<input readonly type="text" name="show" value="{{$v.Show}}"/>
		</div>
		<div class="field"><label>샷</label>
			<input readonly type="text" name="shot" value="{{$v.Shot}}"/>
		</div>
		<div class="field"><label>태스크</label>
			<input readonly type="text" name="task" value="{{$v.Task}}"/>
		</div>
		<div class="field"><label>버전</label>
			<input readonly type="text" name="version" value="{{$v.Version}}" />
		</div>
		<div class="field"><label>소유자</label>
			<input readonly type="text" name="owner" value="{{$v.Owner}}" />
		</div>
		<div class="field"><label>상태</label>
			<input readonly type="text" name="status" value="{{$v.Status.UIString}}" />
		</div>
		<div class="field"><label>프리뷰 이미지</label>
			<input type="text" name="images" value="{{fieldJoin $v.Images}}"/>
		</div>
		<div class="field"><label>프리뷰 Mov</label>
			<input type="file" name="mov"/>
		</div>
		<div class="field"><label>결과물</label>
			<input type="text" name="output_files" value="{{fieldJoin $v.OutputFiles}}"/>
		</div>
		<div class="field"><label>작업 파일</label>
			<input type="text" name="work_file" value="{{$v.WorkFile}}"/>
		</div>
		<div class="field"><label>시작일</label>
			<input type="date" name="start_date" value="{{stringFromDate $v.StartDate}}"/>
		</div>
		<div class="field"><label>(예상)종료일</label>
			<input type="date" name="end_date" value="{{stringFromDate $v.EndDate}}"/>
		</div>
		<div style="display:flex">
		<button class="ui button green" type="submit" value="Submit">수정</button>
		<div style="flex:1"></div>
		{{if $.IsWorkingVersion}}
			{{if eq $v.Status "approved"}}
			<button class="ui button" type="submit" value="Publish" formaction="/update-task-publish-version">퍼블리시</button>
			{{else}}
			<!-- 아래 /update-version-status에 update-status 필드를 쓰는 이유는 status로 했을 경우 form의 status에 의해 덮어 씌어지기 때문이다. -->
			<button class="ui button" type="submit" value="Waiting" formaction="/update-version-status?update-status=waiting">대기</button>
			<button class="ui button" type="submit" value="InProgress" formaction="/update-version-status?update-status=in-progress">진행</button>
			<button class="ui button" type="submit" value="NeedReview" formaction="/update-version-status?update-status=need-review">리뷰요청</button>
			<button class="ui button" type="submit" value="NeedReview" formaction="/update-version-status?update-status=approved">승인(임시)</button>
			{{end}}
		{{else}}
		<button class="ui button" type="submit" value="SetWorkingVersion" formaction="/update-task-working-version">이 버전을 작업중으로 표시</button>
		{{end}}
		</div>
		<div style="height:2rem;"></div>
	</form>
	{{end}}
</div>
{{template "footer.html"}}
