{{template "head.bml"}}
{{template "nav.html" $}}
<div class="ui raised very padded text container grey inverted segment">
	<button onclick="history.back()">되돌아가기</button>
	<h2 class="ui header">태스크 수정</h2>
	<h3 class="ui dividing header" style="color:#BBB">
		<a href="/update-show?id={{$.Show}}" style="color:#9f9f9f">{{$.Show}}</a> /
		{{len $.IDs}} 샷
	</h3>
	<textarea readonly style="width:100%;height:6rem;padding:0.5rem">{{range $i, $id := $.IDs}}{{if ne $i 0}}, {{end}}{{$id}}{{end}}</textarea>
	<div style="height:2rem"></div>
	<form method="post" class="ui form">
		<!-- update-multi-tasks 요청에는 GET을 사용하지 않기 때문에 이 요청이 정말로 POST라는 것을 알림 -->
		<input hidden type="text" name="post" value="1"/>
		{{range $id := $.IDs}}
		<input hidden type="text" name="id" value="{{$id}}"/>
		{{end}}
		<div class="field"><label>태스크</label>
			<select name="task" onchange="taskChanged(this)">
			<option value=""></option>
			{{range $t := $.Tasks}}
				<option value="{{$t}}">{{$t}}</option>
			{{end}}
			</select>
		</div>
		<div class="field"><label>마감일</label>
			<input disabled class="after-task-set" type="date" name="due_date" value="">
		</div>
		<div class="field"><label>상태</label>
			<select disabled class="after-task-set" type="text" name="status">
				<option value="" selected></option>
				{{range $s := $.AllTaskStatus}}
				<option value="{{$s}}">{{$s.UIString}}</option>
				{{end}}
			</select>
		</div>
		<div class="field"><label>담당</label>
			<input disabled class="after-task-set" type="text" name="assignee" value="" />
		</div>
		<button disabled class="ui button green after-task-set" type="submit" value="Submit">수정</button>
		<div style="height:2rem;"></div>
	</form>
</div>
<script>
// taskChanged는 특정 태스크가 선택 되었을때 인풋과 버튼의 잠금을 해제한다.
// 이 페이지에서 사용자가 우선해야 하는 것이 태스크 선택이기 때문이다.
function taskChanged(select) {
	let disabled = (select.value == "")
	for (let el of document.getElementsByClassName("after-task-set")) {
		el.disabled = disabled
	}
}
</script>
{{template "footer.bml"}}
