{{template "head.html" }}
{{template "nav.html" $}}

<div style="width:100%;background-color:rgb(48, 48, 48);padding:15px;">
    <div style="display:flex;">
        <form style="flex:1;display:flex;">
            <select style="width:8rem;" id="show-select" name="show" onchange="refresh()">
                {{range $.Shows}}
                <option value={{.Show}} {{if eq .Show $.Show}}selected{{end}}>{{.Show}}</option>
                {{end}}
            </select>

            <div style="width:2rem"></div>
            <button style="width:5rem;border-radius:2px 0 0 2px;border-right:solid 1px grey;{{if eq $.Category "shot"}}background-color:#FFCC33{{end}}" onclick="selectCategory('shot')">샷</button>
            <button style="width:5rem;border-radius:0 2px 2px 0;{{if eq $.Category "asset"}}background-color:#FFCC33{{end}}" onclick="selectCategory('asset')">애셋</button>
            <input type="hidden" id="category-input" name="category" type="text" value="{{$.Category}}">

            <div style="width:2rem"></div>
            <button style="width:5rem;border-radius:2px 0 0 2px;border-right:solid 1px grey;{{if eq $.Kind "unit"}}background-color:#FFCC33{{end}}" onclick="selectKind('unit')">유닛</button>
            <button style="width:5rem;border-radius:0 2px 2px 0;{{if eq $.Kind "task"}}background-color:#FFCC33{{end}}" onclick="selectKind('task')">태스크</button>
            <input type="hidden" id="kind-input" name="kind" type="text" value="{{$.Kind}}">
        </form>
    </div>
</div>

<div style="padding:15px 10px 15px 10px;z-index:0;">
    {{range $d, $units := $.ByDue}}
    <div class="ui inverted segment">
        <div class="ui grid">
            <div class="ui four wide column">
                <a href="/shots?show={{$.Show}}&q=due-date:{{$d}}">
                    <div style="color:#CCC;" class="ui large header">{{$d}}</div>
                </a>
            </div>
        </div>
        <div class="ui divider">
        </div>
        <div id="show-{{$.Show}}-shots-by-due" class="shots-per-due ui grey inverted segment">
            {{range $u := $units}}
            <a class="ui small label" href="">{{$u.Name}}<div class="detail">{{$u.Status.UIString}}</div></a>
            {{end}}
        </div>
    </div>
    {{end}}
</div>

<script>
// refresh는 현재 설정에 맞는 리뷰 페이지를 다시 부른다.
function refresh() {
    let show = document.getElementById("show-select").value
    let ctg = document.getElementById("category-input").value
    let kind = document.getElementById("kind-input").value
    document.location.href = "?show=" + show + "&category=" + ctg + "&kind=" + kind
}

// selectCategory는 샷 또는 애셋을 선택한 후 리뷰 페이지를 다시 부른다.
function selectCategory(ctg) {
    document.getElementById("category-input").value = ctg
}

// selectKind는 유닛 또는 태스크를 선택한 후 리뷰 페이지를 다시 부른다.
function selectKind(kind) {
    document.getElementById("kind-input").value = kind
}
</script>

{{template "footer.html"}}
