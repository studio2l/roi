{{template "head.html"}}
{{template "nav.html" $}}
<!--상단 고정 메뉴로 인해 위치 조정-->
<div style="padding-top: 2rem;"></div>
<div class="ui raised very padded text container grey inverted segment">
	<h2 class="ui dividing header">태스크 수정</h2>
	<form method="post" class="ui form">
		<div class="field disabled"><label>프로젝트</label>
			<input type="text" name="show" value="{{.Task.Show}}"/>
		</div>
		<div class="field disabled"><label>샷</label>
			<input type="text" name="shot" value="{{.Task.Shot}}"/>
		</div>
		<div class="field disabled"><label>태스크</label>
			<input type="text" name="name" value="{{.Task.Task}}"/>
		</div>
		<div class="field"><label>마감일</label>
			<input type="date" name="due_date" value="{{stringFromDate $.Task.DueDate}}">
		</div>
		<div class="field"><label>상태</label>
			<select type="text" name="status">
				{{with $t := $.Task}}
				{{range $ts := $.AllTaskStatus}}
				<option value="{{$ts}}" {{if eq $ts $t.Status}}selected{{end}}>{{$ts.UIString}}</option>
				{{end}}
				{{end}}
			</select>
		</div>
		<div class="field"><label>담당</label>
			<div class="autocomplete" style="display:grid;grid-template-columns:1fr">
			<input id="autocomplete-user" type="text" name="assignee" value="{{.Task.Assignee}}"/>
			</div>
		</div>
		<button class="ui button green" type="submit" value="Submit">수정</button>
		<div style="height:2rem;"></div>
	</form>

	<h2 class="ui dividing header">
		버전
		<a href="/add-version?show={{$.Task.Show}}&shot={{$.Task.Shot}}&task={{$.Task.Task}}" class="ui right floated mini basic inverted button">추가</a>
	</h2>
	<div class="ui container">
		{{range $v := $.Versions}}
		<!-- 만일 퍼블리시 버전이라면 푸른색, 진행중 버전이라면 초록색으로 표현하고, 퍼블리시의 우선순위가 더 높다. -->
		<a href="/update-version?show={{$v.Show}}&shot={{$v.Shot}}&task={{$v.Task}}&version={{$v.Version}}" class="ui label {{if eq $v.Version $.Task.PublishVersion}}blue{{else if eq $v.Version $.Task.WorkingVersion}}green{{end}}">{{$v.Version}}</a>
		{{end}}
	</div>
</div>

<script>
let userName = {
	{{range $u := $.Users -}}
	"{{$u.ID}}": {{$u.Name}},
	{{end}}
}

let users = [
	{{range $u := $.Users -}}
	"{{$u.ID}}",
	{{end}}
]
users.sort()

autocomplete(document.getElementById("autocomplete-user"), users, userName)
</script>
{{template "footer.html"}}
